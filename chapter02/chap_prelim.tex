\let\textcircled=\pgftextcircled
\chapter{Preliminaries}
\label{chap:prelim}


\bigskip

\section{Mathematical background of quantum theory}

\subsection{Hilbert space theory}

We will be considering separable Hilbert spaces over the complex numbers, where separability is taken to mean the existence of a countable orthonormal basis. We will adopt the convention that the inner product, denoted $\langle\cdot|\cdot\rangle$, is linear in the second slot and conjugate-linear in the first. Such an inner product naturally induces a norm $\norm{\boex} \defeq \sqrt{\langle \boex| \boex\rangle}$. We will use the notation $\bops[V][W]$ for the space of continuous (and equivalently bounded) linear maps between normed vector spaces $V$ and $W$, over the same field, omitting the second argument if the two spaces are the same. This is once more a vector space over the same field, with addition and scalar multiplication being defined pointwise and inherits a natural norm 
\begin{align}
  \norm{\cdot}&:\bops[V][W]\to \K\\
  \norm{T} &\defeq \sup_{\substack{\bov\in V \\ \norm{\bov}\leq 1}}\norm{T\bov}, \label{eqn:operator-norm}
\end{align}
under which it is a Banach space \coma{cite R\&S?}. A particularly important special case is the space of maps $\bops[V][\K]$, where $\K$ is the field underlying $V$, which we will denote $V^*$, and is commonly called the topological dual of $V^*$. A celebrated theorem due to Riesz \cite{riesz-representation-riesz} and Fr{\'e}chet \cite{riesz-representation-frechet}, commonly called the Riesz representation theorem, states that Hilbert space over the reals is isomorphic to its topological dual, and one over the complexes is anti-isomorphic to its dual. More explicitly every continuous linear functional on a Hilbert space is of the form $\Psi_{\bow} :\bov\mapsto \langle{\bow} |\bov\rangle$, for some fixed $\bow\in V$, and the map $\Psi_{\bow}$, defined in this way is a continuous linear functional for every $\bow\in V$.

% Given two vector spaces, $V$, $W$ over the same field $\K$ we define the \emph{tensor product} $V\times W$ by first defining the free vector space over $\K$, $F(V\otimes W)$ generated by the tuples $(\bov, \bow)$ for each $\bov\in V$ and $\bow\in W$. To obtain the tensor product we then quotient by the equivalence relation $\sim$ such that
% \begin{align}
%   (\bov,\bow) + (\bov^\prime, \bow) &\sim (\bov+ \bov^\prime, \bow)\\
%   (\bov,\bow) + (\bov, \bow^\prime) &\sim (\bov, \bow+\bow^\prime)\\
%   c(\bov,\bow) &\sim (c\bov,\bow)\sim (\bov,c\bow),
% \end{align}
% for all $\bov, \bov^\prime\in V$, $\bow,\bow^\prime \in W$, $c\in \K$. We denote the equivalence class $[(\bov,\bow)]$ by $\bov\otimes \bow$.

% We define the \emph{tensor product} $V\otimes W$ of two vector spaces $V$ and $W$ abstractly to be the quotient of the free vector space generated by the symbols $\bov\otimes \bow$, for all $\bov\in V$ and $\bow\in W$, by the relations. We note that if $\hcal$ and $\kcal$ are inner product spaces we may define an inner product on $\hcal\otimes\kcal$ by 
% \begin{align}
%   \langle \phi_1\otimes \psi_1 | \phi_2\otimes \psi_2\rangle = \langle \phi_1 | \phi_2\rangle \langle \psi_1 | \psi_2\rangle,
% \end{align}
% and extending linearly to the whole space. If $V$ and $W$ are Hilbert spaces then $V\otimes W$, with $\otimes$ defined in this way is not generally a Hilbert space, because it is not complete. For Hilbert $\hcal$ and $\kcal$ spaces we call take the completion with respect to the inner product defined above to get $\hcal\otimes\kcal$. As we shall see later, once we have defined the trace of an operator, there is relatively explicit construction of the tensor product of Hilbert spaces in terms of the Hilbert-Schmidt class of operators.

We are often required to consider operators which are not defined on the whole Hilbert space. We use the word operator for a linear map $A$ whose domain, denoted $D(A)$, is a vector subspace of the Hilbert space of interest. A motivating example is the differential operator $\opp:\phi\mapsto -i \phi^\prime$, defined on the subspace of absolutely continuous functions in $L^2(\R)$, whose weak derivatives are also in $L^2(\R)$. We will only consider the case where the domain is dense. If $A:\hcal\to\kcal$ is a linear operator, defined on a dense domain $D(A)\subseteq \hcal$ we may define the domain of the \emph{adjoint} $D(A^*)$, to be the set of vectors $\psi \in \kcal$ for which there exists an $\eta_{\psi}\in \hcal$ such that
\begin{align}
  \langle \psi | A\phi \rangle  = \langle \eta_{\psi}| \phi\rangle,
\end{align}
holds for all $\phi\in D(A)$. We then define $A^*$ on this domain to be
\begin{align}
  A^* \psi = \eta_{\psi},
\end{align}
noting that the density of $D(A)$ ensures that the $\eta_{\psi}$ is unique, for those $\psi$ for which it exists. For $\bops[\hcal]$ the situation is somewhat simpler, the domain of $A$ and $A^*$ can be taken to be $\hcal$, the map $A\mapsto A^*$ is a conjugate linear isomorphism preserving the operator norm \eqref{eqn:operator-norm}, and the equations
\begin{align}
  (AB)^* &= B^* A^*\\
  A^{**} &= A\\
  \left(A^{-1}\right)^* &= \left(A^*\right)^{-1},
\end{align}
hold, with the last equation requiring the additional assumption that $A$ is invertable with bounded inverse. Certain operators are equal to their own adjoint, we call those the self-adjoint, denoted $\saops[\hcal]$, and note that they are a vector space over the reals, where the domain of a sum of two operators is the intersection of the domains. 

Those operators which may be written in the form $A = B^*B$, for some linear operator $B$ are called positive, we denote this with $A\geq 0$. The set of such operators forms a \emph{convex  cone} in $\saops[\hcal]$ \coma{ref to convex section?} denoted $\posops[\hcal]$. For any $\psi\in D(A^*A)$ we have that 
\begin{align}
  \langle\psi | A^* A \psi \rangle &= \langle A \psi | A \psi\rangle \\
                                  &= \norm{A\psi}^2 \geq 0.
\end{align}
It is useful to define a partial order on the self-adjoint operators using the positive operators, we will say $A\geq B$, for self-adjoint $A$ and $B$ if $A-B\geq 0$. Every positive operator $A$ has a square root, a positive operator $B$ such that $A = B^2$, this may easily be shown via the spectral theorem, although also independent proofs exist .

We define the operator absolute value to be
\begin{align}
  \abs{A} \defeq \sqrt{A^*A},
\end{align}
noting that $A^*A$ and $\abs{A}$ are bounded if and only if $A$ is.

If $\seq{\boe_k}[k\in\N]$ is an orthonormal basis for a Hilbert space $\hcal$ then we define the trace of an operator $A\in\bops[\hcal]$ 
\begin{align}
  \tr{A} &= \sum_k \braket{\boe_k}{A\boe_k},
\end{align}
however this quantity is not, in general, independent of the basis chosen, even if it is finite. We consider the restricted class of operators such that
\begin{align}
  \sum_k \braket{\boe_k}{\abs{A}\boe_k},
\end{align}
converges to some real number for any, equivalently every, basis $\seq{\boe_k}[k\in\N]$. We call these operators the \emph{trace-class}, denoted $\trops{\hcal}$. For members of the trace-class the infinite sum
\begin{align}
  \tr{A} &= \sum_k \braket{\boe_k}{A\boe_k},
\end{align}
is \emph{absolutely convergent}, and is independent of the choice of basis. Every trace-class operator is bounded, and compact \coma{talk about compact somewhere}. The trace-class is a vector space over the complex numbers, and we summarise several useful properties,
\begin{itemize}
  \item the trace is a linear functional on the trace-class,
  \item the map $(A, B)\mapsto \tr{A^*B}$ is an inner product on the trace-class,
  \item the map $A\mapsto \sqrt{\tr{A^*A}}$ is a norm on the trace-class, called the Hilbert-Shmidt norm and denoted $\norm{A}_{\text{HS}}$,
  \item $\tr{A^*} = \tr{A}^*$,
  \item if $A$ is trace-class and $B$ is bounded then $AB$ and $BA$ are trace-class, hence the trace class are a two-sided ideal in the bounded operators,
  \item further, the vector-space of maps on the trace-class of the form $A\mapsto\tr{AB}$, where $B$ is bounded is the topological dual of the trace-class.
\end{itemize}

Given two Hilbert spaces $\hcal$ and $\kcal$ there is a Hilbert space $\hcal_\otimes$ and a bilinear map $f:\hcal\times\kcal\to\hcal_\otimes$ such that the subspace $\vspan{\sbuild{f(\phi,\psi)}{\phi\in\hcal, \psi\in\kcal}}$ is dense in $\hcal_\otimes$ and 
$\braket{f(\phi_1,\psi_2)}{f(\phi_2,\psi_2)} = \braket{\phi_1}{\phi_2}\braket{\psi_1}{\psi_2}$ for all $\phi_1,\phi_2\in\hcal$ and $\psi_1,\psi_2\in\kcal$. We write $\hcal_\otimes =: \hcal\otimes\kcal$, called the \emph{tensor product} of $\hcal$ and $\kcal$, noting that it is unique up to isomorphism. Given $S\in\bops[\hcal]$ and $V\in\bops[\kcal]$ there exists a unique operator, $S\otimes T\in\bops[\hcal\otimes\kcal]$ such that 
\begin{align}
  (S\otimes T)(\phi\otimes\psi) = (S\phi)\otimes(T\psi),
\end{align}
holds for all $\phi\in\hcal$ and $\psi\in\kcal$. We call  $(S\otimes T)$ the tensor product of $S$ and $T$ and note the properties
\begin{itemize}
  \item $\alpha(S\otimes T) = (\alpha S)\otimes T = S\otimes(\alpha T)$, for all $\alpha\in\Cx$,
  \item $(S_1 + S_2)\otimes T = S_1\otimes T + S_2 \otimes T$,
  \item $(S_1\otimes T_1)(S_2\otimes T_2) = S_1S_2 \otimes T_1 T_2$,
  \item $(S\otimes T)^* = S^*\otimes T^*$,
  \item if $S$ and $T$ are both self-adjoint, unitary, positive or trace-class then so is $S\otimes T$ respectively,
  \item $\tr{S\otimes T} = \tr{S}\tr{T}$.
\end{itemize}
A very useful partial inverse of the tensor product is the so-called \emph{partial trace}, if $T\in\trops[\hcal\otimes\kcal]$ then there is a unique $T_1\in\trops[\hcal]$ such that
\begin{align}
  \tr{T_1 A} = \tr{T(A\otimes \opi_\kcal)},
\end{align}
holds for all $A\in \bops[\hcal]$. The partial trace is linear, and trace-preserving. It is also positive, in the sense that it maps positive operators to positive operators and completely positive in the sense of definition \ref{defn:completely-positive-map}.

\begin{defn}\label{defn:completely-positive-map}
  A map $\Phi:A\to \bops[\kcal]$, where $A\subseteq \bops[\hcal]$ is a $C^*$-algebra is $k$-positive if the induced map
  \begin{align}
    \operatorname{id}_k\otimes \Phi:\Cx^{k\times k}\otimes A\to \Cx^{k\times k}\otimes\bops[\kcal],
  \end{align}
  is positive, $\Phi$ is \emph{completely positive} if it is $k$-positive for all $k\in\N$.
\end{defn}

\begin{thm}[Stinespring]\label{thm:stinespring}
  Let $\Phi:A\to\bops[\kcal]$ be a completely positive map, where $A\subseteq\bops[\hcal]$ is a $C^*$ algebra, then $\Phi$ is completely positive if and only if it admits the representation
  \begin{align}
    \Phi(X) = V^* \pi(X) V,
  \end{align}
  where $V:\kcal\to\kcal^\prime$ is a a bounded linear map, $\kcal^\prime$ is a Hilbert space and $\pi$ is a $*$-homomorphism of $A$ in $\bops[\tilde{\kcal}]$.
\end{thm}

Of particular interest for applications in quantum theory are the completely positive maps between spaces of trace-class operators which preserve the trace. Recalling that the dual of the trace-class is the space of bounded operators we can define the dual of a trace-preserving completely positive map by requiring that
\begin{align}
  \tr{A \Phi(B)} = \tr{\Phi^*(A) B},
\end{align}
for all $A\in\bops[\hcal]$ and $B\in\trops[\hcal]$. The dual of a trace-preserving completely positive map is again completely positive and is unital $\Phi^*(\opi) = \opi$ and normal in the sense that
\begin{align}
  X_a \uparrow X \implies \Phi^*(X_a) \uparrow \Phi(X).
\end{align}
For detailed information on Stinespring's theorem and the properties of positive and completely positive maps see e.g. \cite{stormer1963} and \cite{stormer1974}.

\subsection{Measures and operator valued measures}

Here $\Omega$ is a set and $\fcal$ is a subset of the power set of $\Omega$ which includes the empty set, is closed under complements and is closed under countable unions. A set with these properties is called a $\sigma$-algebra on $X$. A (positive, extended real) measure is a function $\mu$ from $\Sigma$ to $\R\cup \{\infty\}$ such that
\begin{itemize}
  \item $\forall S\in\fcal $, $\mu(S)\geq 0$
  \item There exists a set $S\in\fcal$ such that $\mu(S) \in\R$
  \item If $\seq{S_k}[k\in\N]$ is a countable sequence of non-intersecting sets in $\fcal$, then $\mu(\bigcup_k S_k) = \sum_k\mu(S_k)$
\end{itemize}
From these it immediately follows that $\mu(\varnothing) = 0$, as $\mu(S) = \mu(S \cup \varnothing\cup\varnothing\ldots) = \mu(S) + \mu(\varnothing) + \mu(\varnothing)\ldots$. We define general extended real, and complex measures in the obvious way, an extended real measure $\mu$ is a pair of positive measures $\mu_\pm$ such that $\mu(S) = \mu_+(S) - \mu_-(S)$, and a complex measure may be defined by its real and imaginary parts. A positive measure such that $\mu(\Omega) = 1$ is called a probability measure, and we denote the set of probability measures on $(\Omega,\fcal)$ with the notation $\probs{\Omega}{\fcal}$. If $\Omega$ has a topology $\tau$ then the Borel $\sigma$-algebra is the smallest $\sigma$-algebra containing the open sets of $\tau$, and the elements of this $\sigma$-algebra are called the Borel sets, all of the probability measures we encounter in this thesis will be Borel, either with respect to the standard topology on the reals or the topology generated by the singleton sets where $\Omega$ is finite.

It is essential for the development of the spectral theory of self adjoint operators to consider ``measures'' which map into (subsets of) the bounded operators on some Hilbert space.

\begin{defn}[Positive operator valued measure]\label{defn:povm}
  A positive operator valued measure on a set $\Omega$ and $\sigma$-algebra $\fcal$ is a function $E:\fcal\to\posops[\hcal]$ such that $E(\Omega) = \opi$ and for all sequences of non-intersecting sets in $\fcal$ $\seq{S_k}[k\in\N]$ we have 
  \begin{align}
    E\left(\bigcup_k \,S_k\right) = \sum_k E(S_k).
  \end{align}
\end{defn}
We note that one can show that the effects (often called POVM elements) $\sbuild{E(S)}{S\in\fcal}$ are bounded operators, in particular $\norm{E(S)\varphi} \leq \norm{E(\Omega)\varphi} = \norm{\varphi}$. We will often be interested in the case where a POVM is a projection valued measure (PVM), in the sense that $E(S)^2 = E(S)$, for all $S\in\fcal$. Equivalent to this definition is a multiplicative property $E(S)E(T) = E(S\cap T)$, for all $S,T\in\fcal$. Given a Borel PVM $E_A$ over the reals there is a a vector subspace $D(A)\subseteq\hcal$ such that the integral
\begin{align}
  \int_\R x d\braket{\psi}{E_A(x)\phi} 
\end{align}
converges for all $\psi,\phi\in D(A)$, and a unique self-adjoint operator $A$ with domain $D(A)$ such that 
\begin{align}
  \braket{\psi}{A\phi} = \int_\R x dE_a(x),
\end{align}
for $\psi$, $\phi$ in the domain.

We give several version of the spectral theorem, the first of which is the converse of the above statement.

\begin{thm}[Spectral theorem for self-adjoint operators]
  If $\opa$ is a self-adjoint operator with dense domain $D(A)$, then there is a unique PVM $E_A$ such that
  \begin{align}
    \braket{\psi}{A\phi} = \int_\R x d\braket{\psi}{E_A(x)\phi},
  \end{align}
  holds for all $\psi,\phi\in D(A)$.
\end{thm}

\begin{thm}[Spectral theorem for self-adjoint operators - bounded functional calculus]\label{thm:spectral-sa-ops-bounded-functions}
    Let $A$ be a self-adjoint operator on $\hcal$, there is a unique map $\hat{\phi}$ from the bounded Borel functions on $\R$ to $\bops[\hcal]$ such that
    \begin{itemize}
      \item $\hat{\phi}$ is an algebraic $*$-homomorphism,
      \item $\hat{\phi}$ is norm continuous $\norm{\hat{\phi}(h)} \leq \norm{h}_\infty$,
      \item if $h_n$ is a sequence of bounded Borel functions converging (pointwise) to the identity function and $\abs{h_n(x)} \leq x$ for all $x$ and $n$, then for any $\psi\in D(A)$ we have $\lim_{n\to\infty} \hat{\phi}(h_n)\psi = A\psi$,
      \item if $h_n \to h$ pointwise and the sequence $\norm{h_n}_\infty$ is bounded then $\hat{\phi}(h_n) \to \hat{\phi}(h)$ strongly,
      \item if $A\psi$ = $\lambda\psi$ then $\hat{\phi}(h)\psi = h(\lambda)\psi$,
      \item if $h\geq 0$ then $\hat{\phi}(h) \geq 0$.
    \end{itemize}
\end{thm}

We use this as a stepping stone to a more general formulation

\begin{thm}[Spectral theorem for self-adjoint operators - Borel functional calculus]\label{thm:spectral-sa-ops-unbounded-functions}
  Let $A$ be a self-adjoint operator on $\hcal$, and $\chi_\Omega$ the characteristic function of the measurable set $\Omega\subseteq\R$. We define the operators $P_\Omega = \hat{\phi}(\chi_\Omega)$, and note the properties
  \begin{itemize}
    \item the $P_\Omega$ are orthogonal projections,
    \item $P_\R = I$ and $P_\varnothing = 0$,
    \item if $\Omega$ is a countable union of disjoint sets $\Omega_n$ then $P_\Omega = \lim_{N\to\infty} \sum_{n=1}^N P_{\Omega_n}$, where the limit converges strongly,
    \item $P_\Omega P_\Delta = P_{\Omega\cap\Delta}$.
  \end{itemize}
  We call the map $E_A:\Omega\mapsto P_\Omega$ the spectral measure of $A$. The map $\Omega\mapsto\langle\psi| P_\Omega \phi\rangle$ is a complex-valued Borel measure on $\R$ for each $\psi, \phi\in\hcal$ and denote it $\mu_{\psi\phi}$. If $g$ is a bounded Borel function on $\R$ then we can define $g(A)$ by
  \begin{align}
    \langle \psi|g(A)\phi\rangle = \int_\R g(\lambda)\,d\mu_{\psi\phi}(\lambda),
  \end{align}
  and note that this agrees with $\hat{\phi}(g)$, further if $g$ is an unbounded, complex valued, Borel function on $\R$ we can define 
  \begin{align}
    D(g(A)) &= \sbuild{\psi}{\int_\R \abs{g(\lambda)}^2 d\mu_{\psi\psi}(\lambda)<\infty}\\
    \langle \psi | g(A)\phi\rangle &= \int_\R g(\lambda) d\mu_{\psi\phi}(\lambda),
  \end{align}
  We write $g(A) = \int_\R g(\lambda) P_\lambda$, and note that $g(A)$ is self-adjoint if $g$ is real. 
\end{thm}
We call the support of a self-adjoint operator $A$, $\supp{A}$, the complement of the union of all the open sets $\Omega$ for which $P_\Omega = 0$, and note that we can restrict the integrals over $\R$ in the previous theorem to over $\supp{A}$, we therefore allow Borel functions defined on $\supp{A}$, rather than requiring that they are defined on the whole real line. One may generalise the spectral theorem much further, but this is beyond the scope of this thesis. We note that the definition of the support given here matches the spectrum, for a self-adjoint operator the terms are interchangeable. 

Some important special cases are: the spectral measure of a compact operator is supported on a finite number of points, or a sequence of points which converges to zero; the spectral measure of an operator on a finite dimensional Hilbert space is supported on a finite number of points; the spectral measure of a positive operator is supported within the non-negative real numbers.

\section{Convex analysis}

Convex analysis concerns itself with convex sets and convex functions. Although there is an interesting theory of convex subsets of infinite dimensional vector spaces \coma{cite?} this is beyond the scope of this thesis. Here all convex sets will be subsets of finite dimensional real vector spaces. We will follow the exposition of Rockerfellar \cite{rtr-conv-anal-book}. We write as $V^*$ the topological dual space of a topological vector space $V$, the space of continuous linear functionals on $V$. Since we are only dealing with finite dimensional spaces a vector space $V$ is canonically isometrically isomorphic to its bidual $V^{**}$, and we do not distinguish the two, equating the vector $\boex\in V$ and the evaluation map $(\psi\mapsto\psi(\boex))\in V^{**}$. This identification is convenient for discussing the convex conjugate of a function.

\begin{defn}\label{defn:convex-set}
  A subset $C$ of a real vector space is \emph{convex} if for all $\boex,\boy\in C$ and for all $\lambda\in [0,1]$
  \begin{align}
    \lambda \boex + (1-\lambda)\boy\in C.
  \end{align}
\end{defn}
Examples of convex sets include
\begin{itemize}
  \item Any interval in the reals (viewed as a one dimensional vector space over themselves)
  \item The balls in any normed vector space over the reals
  \item The state-space $\dops$ of quantum mechanics
  \item The set of points in $\R^2$ that lie ``above'' the graph of the function $x\mapsto x^2$, i.e. the set of points $\sbuild{(x,y)}{y > x^2}$.
\end{itemize}
This last example motivates the definition of a convex function
\begin{defn}\label{defn:epigraph}
  The \emph{epigraph} of a function $f:V\to\R$, where $V$ is a real vector space is the set of points in the vector space $V\oplus \R$ \coma{is direct sum correct here??} ``above'' the graph of $f$
  \begin{align}
    \epi f = \sbuild{(v, \mu)}{v\in V,\, \mu\in\R, \mu \geq f(v)}.
  \end{align}
\end{defn}
\begin{defn}\label{defn:real-convex-function}
  A function from a real vector-space to the reals is \emph{convex} if its epigraph is a convex set.
\end{defn}
This definition of convexity for functions is slightly too restrictive, because it only covers functions defined on an entire vector space $V$. We will mainly be concerned with, for example, uncertainty measures which are non-negative, and so we are motivated to find a definition of convexity appropriate for more general domains.
\begin{defn}\label{defn:extended reals}
  We define the \emph{extended reals} as an extension of the ordered field of real numbers $\exR = \R \cup \{\infty, -\infty\}$ with the following axioms
  \begin{enumerate}
    \item $\forall x\in\R$, $\infty > x$ and $-\infty < x$,
    \item $\forall x\in\R$, $x + \infty = \infty + x = \infty$,
    \item $\forall x\in\R$, $x + \infty = \infty + x = \infty$,
    \item $\infty + \infty = \infty$ and $-\infty - \infty = -\infty$,
    \item $\forall x\in\R$, $x>0 \implies x\infty = \infty x =  \infty$ and $x(-\infty) = (-\infty)x = -\infty$,
    \item $\forall x\in\R$, $x<0 \implies x\infty = \infty x = -\infty$ and $x(-\infty) = (-\infty)x = \infty$,
    \item $0 \infty = \infty 0 = 0 = 0(-\infty) = (-\infty)0$,
    \item $\inf\varnothing = \infty$ and $\sup\varnothing = -\infty$.
  \end{enumerate}
\end{defn}
We can now consider functions defined on arbitrary convex subsets of real vector spaces, simply by extending the function to be $\infty$ outside. We note that strictly this recourse to the extended reals is unnecessary and one can consider convex functions defined on convex subsets of real vector spaces directly, but this leads to more tedious consideration of domains. In the present formulation one can recover the domain by considering the points where the extended function takes finite values. It is also important to note that the forms $\infty-\infty$ and $-\infty +\infty$ are left undefined. As Rockerfellar notes, it is important in principle to be cautious when these cases arise, but in practice they occur very rarely.

For completeness we define the epigraph and convexity for extended real functions, although these are essentially identical to definitions given above.
\begin{defn}\label{defn:extended-convex-function}
  A function $f:V\to\exR$, where $V$ is a real vector space, is \emph{convex} if its epigraph
  \begin{align}
    \epi f = \sbuild{(v,\mu)}{v\in V,\,\mu\in \R,\,\mu\geq f(v)},
  \end{align}
  is a convex subset of $V\oplus R$. Note that if $f(v) =\infty$ there are no $\mu\in\R$ such that $\mu\geq f(v)$, so these $v$ do not occur in any of the ordered pairs in $\epi f$.
\end{defn}
We now state two theorems useful theorems of convex functions
\begin{thm}\label{thm:jensen-two-point}
  Let $f:V\to (-\infty, \infty]$, with $V$ a real vector space. Then $f$ is convex if and only if the inequality
  \begin{align}
    f(\lambda \boex + (1-\lambda)\boy) \leq \lambda f(\boex) + (1-\lambda)f(\boy),
  \end{align}
  holds for all $\boex,\boy\in V$ and $\lambda\in [0,1]$. The exception of $-\infty$ is to exclude pathological cases where $f(\boex)$ and $f(\boy)$ are different infinite values.
\end{thm}
\begin{thm}[Jensen's inequality]\label{thm:jensen-n-point}
  Let $f:V\to (-\infty, \infty]$, with $V$ a real vector space. Then $f$ is convex if and only if the inequality
  \begin{align}
    f\left( \sum_{i=1}^n \lambda_i \boex_i \right) \leq \sum_{i=1}^n\lambda_i f(\boex_i),
  \end{align}
  holds for all $\boex_i\in V$ and $\lambda_i\in [0,1]$ such that $\sum_{i=1}^{n}\lambda_i = 1$.
\end{thm}
There are also generalisations to countable sets of points, and probability measures in the uncountable case.

It is useful to define the \emph{convex conjugate} of a function, we will apply this extensively in section \coma{put something here when you've written the section}

\begin{defn}\label{defn:convex conjugate}
  Given a function $f:V\to\exR$, where $V$ is a topological vector space over the reals, we define the convex conjugate of $f$ to be
  \begin{align}
    f^*&:V^*\to \exR\\
    f^*&:\boalpha\mapsto\sup_{\bov\in V} \{\langle\boalpha,\bov\rangle - f(\bov)\},
  \end{align}
  where, $V^*$ is the space of continuous linear functionals on $V$ and $\langle\cdot,\cdot\rangle$ denotes the dual pairing between $V$ and $V^*$. 
\end{defn}

\begin{thm}
  The biconjugate $f^{**}$ of a function $f:V\to\exR$ is greatest (pointwise) lower-semi continuous function which is bounded above by $f$.
\end{thm}

Where $f$ is a convex function $(f^*)^*$ (hereafter denoted $f^{**}$) is equal to $f$.

\section{Semidefinite programming}

The usual formulation \coma{e.g. cite} of semi-definite programming is in terms of $n\times n$ positive-semidefinite real matrices with real elements. Here, following the exposition given in \cite{w-semidefinite-prog-cb-norms}, we use a different but entirely equivalent formulation better adapted to problems in quantum mechanics. 

\begin{defn}\label{defn:complex-semidefinite-program}
  Let $\hcal$, $\kcal$ be finite dimensional Hilbert spaces, $\opc\in\saops[\hcal]$, $\opd\in\saops[\kcal]$ and let $\Psi:\saops[\hcal]\to\saops[\kcal]$ be a linear map. The \emph{primal semidefinite problem} and \emph{dual semidefinite problem}  associated to the triple $\left(\Psi, \opc, \opd\right)$ are
  \begin{equation}
  \begin{aligned}
    & \underset{X\in\posops[\hcal]}{\text{maximise}} & &\tr{\opc X } \qquad\qquad & & \underset{Y\in\posops[\kcal]}{\text{minimise}} & & \tr{\opd Y} \\
    & \text{subject to} & &\Psi(X) \leq \opd & & \text{subject to} & &  \Psi^*(Y) \geq C,
  \end{aligned}
  \label{eqn:semidefinite-program}
\end{equation}
respectively.
\end{defn}

Here it is traditional to note the analogy with the classical theory of linear programming,  we therefore note the duality theorem for linear programs \eqref{thm:duality-linear-prog} from ref.~\cite{schrijver-lin-int-prog}.
\begin{thm}\label{thm:duality-linear-prog}
  Let $\opa\in\R^{n\times m}$, $\boc\in\R^n$ and $\bob\in\R^m$ then
  \begin{align}
    \sup\left\{\boc\cdot \boex \middle| \boex\in\R^n,\, A \boex \leq \bob\right \} = \inf\left\{ \bob\cdot\boy \middle|\boy\in\R^m,\, A^T \boy= \boc\right \},
  \end{align}
  if at least one of the sets is non-empty, with the convention that the $\sup$ and $\inf$ of an empty set are $-\infty$ and $\infty$ respectively.
\end{thm}
  
The analogy follows from considering the trace of the product of two operators as an inner product on the (real) vector vector space of self-adjoint operators on a given Hilbert space. The extra complication that comes from considering operator inequalities rather than vector inequalities causes the duality theory for semidefinite programs to be somewhat weaker than that for linear programs.

\begin{defn}\label{defn:semidefinite-feasible-sets}
  Given a triple $\left(\Psi, \opc, \opd\right)$, chosen as in definition \ref{defn:complex-semidefinite-program} we define the \emph{primal feasible set} and \emph{dual feasible set} to be
  \begin{align}
    \pcal &= \sbuild{X\in\posops[\hcal]}{\Psi(X)\leq \opd},
  \end{align}
  and
  \begin{align}
    \dcal &= \sbuild{Y\in\posops[\kcal]}{\Psi^*(Y)\geq \opc},
  \end{align}
  respectively.
\end{defn}

\begin{thm}[Weak duality]\label{thm:weak-duality-semidefinite-prog}
  For every triple $\left(\Psi, \opc, \opd\right)$ chosen as in definition \ref{defn:complex-semidefinite-program} the inequality
  \begin{align}
    \sup_{X\in\pcal} \tr{\opc X} \leq \inf_{Y\in\dcal} \tr{\opd Y},
  \end{align}
  holds. A proof is contained in ref.~\cite{Vandenberghe-Boyd-semidefinite}.
\end{thm}

We call a semidefinite problem \emph{strongly dual} if we have
\begin{align}\label{eqn:strong-duality-equality}
  \sup_{X\in\pcal} \tr{\opc X} = \inf_{Y\in\dcal} \tr{\opd Y},
\end{align}
although necessary conditions are not easy to find Slater's condition \cite{slater1950} is sufficient to prove strong duality, and in practice is how such problems are approached.
\begin{thm}{Slater's condition}\label{eqn:slaters-condition-sufficient}
  Let $\left(\Psi, \opc, \opd\right)$ be chosen as in definition \ref{defn:complex-semidefinite-program} then the following two implications hold
  \begin{enumerate}
  \item If $\inf_{Y\in\dcal} \tr{\opd Y} \in\R$ and there exists an operator $X> 0$ such that $\Psi(X) < \opd$, then the equality \eqref{eqn:strong-duality-equality} holds and there exists an operator $Y\in\dcal$ achieving the infimum.
  \item If $\sup_{Y\in\pcal} \tr{\opc X} \in\R$ and there exists an operator $Y> 0$ such that $\Psi^*(Y) > \opc$, then the equality \eqref{eqn:strong-duality-equality} holds and there exists an operator $X\in\pcal$ achieving the supremum.
  \end{enumerate}
\end{thm}

\section{Quantum theory}

%\subsection{Notation and conventions}

Throughout this thesis we will use the standard formulation of quantum mechanics, in the main following the exposition of references \cite{quantum-measurement-busch-et-al} and \cite{statistical-structure-quantum-holevo}. All Hilbert spaces may be assumed to be over the field of complex numbers. The quantum states will be the positive, trace-class operators on $\hcal$ with trace equal to $1$ and will be denoted $\dops[\hcal]$. There is a natural convex structure to the states, given states $\rho$ and $\sigma$ and a real $\lambda \in[0,1]$ the convex combinations $\lambda\rho + (1-\lambda)\sigma$ are states which may be interpreted as preparing $\rho$ with probability $\lambda$ and $\sigma$ with probability $1-\lambda$. We also allow countable combinations $\sum_{i\in\N}\lambda_i\rho_i$, where $\lambda_i \geq 0$ and $\sum_{i\in\N}\lambda_i = 1$, to be interpreted analogously. There are certain operators which may not be expressed as a convex combination in a non-trivial way, i.e. a decomposition $\rho = \sum_{i\in\N} \lambda_i\rho_i$ requires that $\rho_i\neq \rho \implies \lambda_i = 0$. We call these the pure states of quantum theory, an application of the spectral theorem shows that they are given by rank-$1$ projections and that every quantum state may be written as a countable convex combination of pure states.

We expect the observables of quantum theory to be maps taking a quantum state and to a probability measure over an outcome set. This matches what happens in experiments, where one applies an observable to an input state and gets an output drawn from some probability distribution. It is natural to require that these maps respect the convex structure of the state-space, in the sense that if one prepares a probabilistic mixture of states, and measures an observable, one expects the probability distribution obtained on the mixture of states to be the mixture of the probability distributions obtained from the original states. 
\begin{defn}
  Let $(\Omega,\fcal)$ be a measure space and $\hcal$ a Hilbert space. A map $M:\dops[\hcal]\to\probs{\Omega}{\fcal}$ is linear if for all convex combinations of states $\sum_{i\in\N} \lambda_i \rho_i$ we have
  \begin{align}
    M\left(\sum_{i\in\N} \lambda_i \rho_i\right) = \sum_{i\in\N} \lambda_i M\left(\rho_i\right),
  \end{align}
  where addition and scalar multiplication of measures is defined pointwise.
\end{defn}

Maps of this form have a useful representation in terms of positive operator valued measures

\begin{thm}
  Let $(\Omega,\fcal)$ be a measure space, $\hcal$ a Hilbert space and let $M:\dops[\hcal]\to\probs{\Omega}{\fcal}$ be a linear map, then there exists a POVM $E:\fcal\to\posops[\hcal]$ such that
  \begin{align}
    M(\rho):X\to \tr{E(X)\rho}.
  \end{align}
\end{thm}
% \begin{proof}
%   We begin by noting that for any fixed $X\in\acal$ the map $\rho\mapsto M(\rho)(X)$ extends to a linear functional on $\trops[\hcal]$, by the well known duality $\trops[\hcal]^* \simeq \bops[\hcal]$ there is an element $\ope(X)\in\bops[\hcal]$ such that $M(\rho)(X) = \tr{\rho\ope(X)}$, for all $\rho\in\dops[\hcal]$. Varying $\rho$ we see that $\ope(X)$ is positive and bounded by the identity $\opi$, now varying $X$ we see that $\ope(\Omega) = \opi$, and the $\ope$ is $\sigma$-additive, and is therefore a POVM.
% \end{proof}
As noted in \cite{quantum-measurement-busch-et-al} the proof of this theorem is essentially identical to the methods used in \cite{Neumann1927}, although with weaker assumptions on the observables. The converse is also true, each POVM gives rise to a linear map from the state-space to the space of probability measures. We denote the probability measure obtained by the pairing between a POVM $\ope$ and a state $\rho$ with $\ope_\rho:X\mapsto \tr{\ope(X)\rho}$.

We henceforth consider POVMs and linear maps to be interchangeable, and use the term ``observable'' for both. Where the outcome set $\Omega$ is finite, and the set of events $\acal$ is the entire power set of $\Omega$ a simpler definition suffices, in this case a POVM is defined entirely by its action on the singleton sets, so we can equivalently consider a map $\ope:\Omega\to\posops$, such that $\sum_{\omega\in\Omega} \ope(\omega) = \opi$.

% For the most part we will deal only with probability spaces where the outcome set is $\Omega\subseteq\R$, in this case we can define the variance of a probability measure $\mu$
% \begin{align}
%   \var{\mu} \defeq \inf_{x_0\in\R}\int_\Omega (x-x_0)^2 d\mu(x),
% \end{align}
% similarly where $\ope$ is a POVM with outcome set a subset of the reals we define
% \begin{align}
%   \var[\rho]{\ope} \defeq \var{\ope_\rho}.
% \end{align}
% Where it makes the text simpler we may use a self-adjoint operator in place of a POVM in such formulae, in these cases we take the measure to be the spectral measure of the operator.

The time evolution will be given by quantum channels, those linear maps from the trace-class operators on one Hilbert space to the trace-class operators on another which preserve the trace, and are completely positive. A corollary of Stinespring's theorem\ref{thm:stinespring}, states that the completely positive maps from a Banach space $\ucal\subseteq\bops[\hcal]$ to $\bops[\mathcal{K}]$ are exactly those which may be written in the form
\begin{align}
  \Phi(\rho) = \tr{U \rho\otimes\rho_0 U^*}[\hcal_0],
\end{align}
where $\hcal_0$ is a Hilbert space and $\rho_0$ is a quantum state in $H_0$. One may, alternatively, consider the quantum state to be unchanging and allow the observables to evolve. This ``Heisenberg picture'' (in contrast to the former ``Schr\"odinger picture'') formulation is furnished by the dual map, and is sometimes more convenient.

The dynamics of a perfectly isolated quantum system are reversible, through Wigner's theorem it is possible to show that the bijective channels are those of the form
\begin{align}
  \Phi:\rho&\mapsto U\rho U^*\\
  \Phi^*:E(X)&\mapsto U^* E(X) U,
\end{align}
where $U:\hcal\to\hcal$ is a unitary or anti-unitary map, see \cite{wigner1960} for a translation of the original work \cite{wigner1931}, or \cite{bargmann1964-wigner} for a detailed proof. The time evolution of quantum mechanics is given by the unitary case, although the anti-unitary operators will be useful in section \coma{ref} when we consider observables symmetric under the action of some group.


% \begin{align}
%   \phi(A) = V^* \pi(A) V,
% \end{align}
% where $V:\kcal\to\tilde{\kcal}$ is a bounded linear map and $\pi:\ucal\to\bops[\tilde{\kcal}]$ is a $*$-homomorphism. A corollary of this is that the trace preserving completely positive maps from $\trops[\hcal]$ to $\trops[\hcal]$ are exactly those which may be written in the form
